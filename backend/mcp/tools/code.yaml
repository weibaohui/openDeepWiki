namespace: code
description: 代码分析工具
version: "1.0"

tools:
  - name: parse_ast
    description: 解析代码生成 AST
    parameters:
      - name: file_path
        type: string
        required: true
      - name: language
        type: string
        required: false
        description: 编程语言，自动检测
    returns:
      ast: object
      language: string
      imports: array
      exports: array

  - name: extract_functions
    description: 提取文件中的函数列表
    parameters:
      - name: file_path
        type: string
        required: true
      - name: include_body
        type: boolean
        required: false
        default: false
    returns:
      functions: array
        # name, signature, line_start, line_end, params, returns, complexity

  - name: get_call_graph
    description: 生成函数调用图
    parameters:
      - name: entry_point
        type: string
        required: true
        description: 入口文件或函数
      - name: depth
        type: integer
        required: false
        default: 3
        description: 调用深度限制
    returns:
      graph: object
        # nodes, edges

  - name: calculate_complexity
    description: 计算代码圈复杂度
    parameters:
      - name: file_path
        type: string
        required: true
      - name: function_name
        type: string
        required: false
    returns:
      complexity: integer
      functions: array
        # name, complexity
      rating: string  # A, B, C, D, E, F

  - name: get_file_tree
    description: 获取代码文件树
    parameters:
      - name: repo_path
        type: string
        required: true
      - name: include_tests
        type: boolean
        required: false
        default: true
    returns:
      tree: object
      total_files: integer
      languages: map

  - name: get_snippet
    description: 获取代码片段
    parameters:
      - name: file_path
        type: string
        required: true
      - name: line_start
        type: integer
        required: true
      - name: line_end
        type: integer
        required: true
      - name: context
        type: integer
        required: false
        default: 0
        description: 额外上下文行数
    returns:
      snippet: string
      lines: [integer, integer]

  - name: get_dependencies
    description: 获取文件依赖关系
    parameters:
      - name: file_path
        type: string
        required: true
      - name: direction
        type: string
        required: false
        default: "both"  # import, export, both
    returns:
      imports: array
      exports: array
      internal_deps: array
      external_deps: array

  - name: find_definitions
    description: 查找符号定义
    parameters:
      - name: symbol
        type: string
        required: true
      - name: repo_path
        type: string
        required: true
      - name: type
        type: string
        required: false  # function, class, variable, all
    returns:
      definitions: array
        # file, line, type, name, signature
