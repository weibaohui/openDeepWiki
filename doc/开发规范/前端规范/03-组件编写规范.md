# 组件编写规范

本文档定义 React 组件的编写规范，包括命名、结构和导出规则。

## 组件文件命名

- 使用 **PascalCase** 命名组件文件：`UserProfile.tsx`
- 页面组件放在 `pages/` 目录
- 通用组件放在 `components/` 目录

## 组件结构模板

```tsx
// 1. 导入语句（按顺序）
import { useState, useEffect } from 'react';          // React 核心
import { useNavigate } from 'react-router-dom';       // 第三方库
import { Button } from '@/components/ui/button';      // UI 组件
import { cn } from '@/lib/utils';                     // 工具函数
import type { Repository } from '@/types';            // 类型定义
import { repositoryApi } from '@/services/api';       // API 服务

// 2. 类型定义
interface Props {
  id: string;
  className?: string;
  onSuccess?: () => void;
}

// 3. 组件实现
export function ComponentName({ id, className, onSuccess }: Props) {
  // 3.1 Hooks（按顺序：状态、路由、副作用）
  const [loading, setLoading] = useState(false);
  const [data, setData] = useState<Repository | null>(null);
  const navigate = useNavigate();

  // 3.2 副作用
  useEffect(() => {
    fetchData();
  }, [id]);

  // 3.3 事件处理函数
  const fetchData = async () => {
    setLoading(true);
    try {
      const res = await repositoryApi.get(Number(id));
      setData(res.data);
    } catch (error) {
      console.error('Failed to fetch:', error);
    } finally {
      setLoading(false);
    }
  };

  const handleClick = () => {
    onSuccess?.();
  };

  // 3.4 条件渲染
  if (loading) {
    return <div>Loading...</div>;
  }

  // 3.5 主渲染
  return (
    <div className={cn('flex flex-col gap-4', className)}>
      {/* 内容 */}
    </div>
  );
}

// 4. 默认导出（页面组件使用）
export default ComponentName;
```

## 导入语句顺序

1. React 核心模块
2. 第三方库
3. UI 组件
4. 工具函数
5. 类型定义（使用 `import type`）
6. API 服务

## 组件导出规则

| 组件类型 | 导出方式 | 示例 |
| -------- | -------- | ---- |
| 页面组件 | `export default` | `export default HomePage;` |
| 通用组件 | 命名导出 | `export function Button() {}` |
| UI 组件 | 遵循 shadcn/ui | 按 shadcn/ui 规范 |

## Hooks 顺序

在组件内部，Hooks 应按以下顺序组织：

1. `useState` - 状态定义
2. `useRef` - 引用
3. `useContext` - 上下文
4. `useNavigate` / `useParams` - 路由相关
5. `useMemo` / `useCallback` - 计算缓存
6. `useEffect` - 副作用

## 相关文档

- [类型定义规范](./10-类型定义规范.md)
- [命名规范](./11-命名规范.md)
