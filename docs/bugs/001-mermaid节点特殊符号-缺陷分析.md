# 0. 文件修改记录表

| 修改人 | 修改时间 | 修改内容 |
| ------ | -------- | -------- |
| AI     | 2026-02-11 | 新增缺陷分析 |

# 1. 根因分析
Mermaid 语法要求节点文本中包含特殊符号时需要使用双引号包裹。当前渲染流程仅做了 Unicode 解码与括号清理，没有对特殊符号节点进行引号补齐，导致解析失败。

# 2. 触发条件
- 节点文本包含 `#` 或 `[]` 等特殊符号
- 节点文本未被双引号包裹
- Mermaid 渲染阶段使用原始节点文本进行解析

# 3. 影响评估
- 图表渲染失败，用户只能看到错误提示
- 对普通节点文本无影响
- 影响范围局部，主要集中在包含特殊符号的节点文本

# 4. 解决思路
在 Mermaid 渲染前增加节点文本修复逻辑，识别 `节点ID[文本]` 结构，若文本包含特殊符号且未加双引号，则自动补齐双引号。

# 5. 方案边界
- 仅处理未加引号的节点文本
- 不改变节点 ID 与其它 Mermaid 语法结构
- 保持现有 Unicode 解码与括号清理逻辑不变
