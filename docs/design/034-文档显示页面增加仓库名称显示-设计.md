# 034-文档显示页面增加仓库名称显示-设计.md

# 0. 文件修改记录表

| 修改人 | 修改时间 | 修改内容 |
| ------ | -------- | -------- |
| AI | 2026-02-11 | 初始版本 |

## 1. 概述
在文档显示页左上角增加仓库名称显示，并在仓库名称下方提供跳转和复制图标按钮，帮助用户识别文档来源仓库，并方便访问和分享仓库地址。

---

## 2. 页面与交互设计

### 2.1 展示位置
- 位于文档显示页 Header 区域的标题之前
- 文档概览页同样位置

### 2.2 布局结构
```
┌─────────────────────────────────────────┐
│ [仓库名称]                              │
│ ↗  📋  [文档标题 / 概览标题]           │
└─────────────────────────────────────────┘
```

### 2.3 交互设计
1. **仓库名称**：纯文本显示，不可点击
2. **跳转图标（↗）**：
   - 图标：`ExportOutlined`（从 @ant-design/icons 导入）
   - 点击行为：在新标签页打开仓库地址（repository.url）
   - 无效状态：仓库地址为空时不显示或禁用
3. **复制图标（📋）**：
   - 图标：`CopyOutlined`（从 @ant-design/icons 导入）
   - 点击行为：将仓库地址复制到剪贴板，显示 "复制成功" 提示
   - 无效状态：仓库地址为空时不显示或禁用

### 2.4 响应式设计
- 桌面端：仓库名称和图标按钮横向排列
- 移动端：保持横向排列，适当调整间距和图标大小

---

## 3. 数据获取
- 使用仓库 ID 调用 `repositoryApi.get` 获取仓库详情
- 文档内容与文档列表依旧来自 `documentApi`
- 仓库请求失败时不影响文档展示
- `repository.url` 用于跳转和复制功能

---

## 4. 接口设计
- 复用现有接口：

```
GET /repositories/:id
```

- 响应字段：
  - `name`: 仓库名称（用于显示）
  - `url`: 仓库地址（用于跳转和复制）

---

## 5. 代码改动范围
| 模块 | 说明 |
| --- | --- |
| DocViewer 页面 | 增加仓库名称展示及图标按钮 |
| i18n 文案 | 新增"复制成功"、"仓库地址为空"等中英文文案 |

---

## 6. 实现细节

### 6.1 组件结构
在 DocViewer.tsx 的 Header 部分，在 Title 组件之前增加仓库名称和图标按钮：

```tsx
<div style={{ marginBottom: 8 }}>
    <Typography.Text type="secondary" style={{ fontSize: '14px' }}>
        {repository?.name}
    </Typography.Text>
    {repositoryUrl && (
        <Space size={8}>
            <Button
                type="text"
                icon={<ExportOutlined />}
                onClick={() => window.open(repositoryUrl, '_blank')}
                size="small"
                title={t('common.open_repository')}
            />
            <Button
                type="text"
                icon={<CopyOutlined />}
                onClick={() => {
                    navigator.clipboard.writeText(repositoryUrl);
                    messageApi.success(t('common.copy_success'));
                }}
                size="small"
                title={t('common.copy_repository_url')}
            />
        </Space>
    )}
</div>
```

### 6.2 图标选择
- 跳转图标：`ExportOutlined`
- 复制图标：`CopyOutlined`

### 6.3 国际化文案
需要新增以下文案（在 i18n 文件中）：

#### zh-CN.json
```json
{
    "common": {
        "open_repository": "打开仓库",
        "copy_repository_url": "复制仓库地址",
        "copy_success": "复制成功",
        "repository_url_empty": "仓库地址为空"
    }
}
```

#### en-US.json
```json
{
    "common": {
        "open_repository": "Open Repository",
        "copy_repository_url": "Copy Repository URL",
        "copy_success": "Copied successfully",
        "repository_url_empty": "Repository URL is empty"
    }
}
```

---

## 7. 风险与兼容性
- 仓库信息获取失败时，文档内容仍可正常阅读与编辑
- 仓库地址为空时，图标按钮不显示
- 复制功能使用 `navigator.clipboard.writeText` API，需要浏览器支持
- 移动端点击区域需要足够大，确保易用性

---

## 8. 安全与权限
- 沿用现有的鉴权机制（假设 API 路由受保护）
- 不在日志中输出仓库地址等敏感信息
