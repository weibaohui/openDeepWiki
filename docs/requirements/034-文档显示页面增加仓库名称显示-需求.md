# 034-文档显示页面增加仓库名称显示-需求.md

# 0. 文件修改记录表

| 修改人 | 修改时间 | 修改内容 |
| ------ | -------- | -------- |
| AI | 2026-02-11 | 初始版本 |
| AI | 2026-02-11 | 调整需求：仓库名称不可点击，增加跳转和复制图标 |
| AI | 2026-02-11 | 调整位置：仓库名称显示在左侧边栏顶部 |
| AI | 2026-02-11 | 调整样式：增大仓库名称字体，在概览页显示仓库名称 |
| AI | 2026-02-11 | 增加文档更新时间、分支和commit id信息 |

# 1. 背景（Why）
文档展示页当前在左上角仅显示文档标题（或概览标题），无法明确该文档属于哪个代码仓库。用户在多仓库场景下或通过外部链接直接打开文档页时，容易混淆来源。为了方便读者明确知晓当前是哪个仓库的文档，需要在左侧边栏顶部增加仓库名称的显示，并在文档概览页也显示仓库名称。同时，增加文档更新时间、分支和commit id信息，帮助用户了解仓库的更新情况。

# 2. 目标（What，必须可验证）
- [ ] 文档展示页左侧边栏顶部显示仓库名称（字体较大）
- [ ] 文档概览页内容区域顶部显示仓库名称（字体较大）
- [ ] 仓库名称下方显示两个图标操作按钮
- [ ] 跳转图标：点击跳转到仓库地址（GitHub/GitLab 等）
- [ ] 复制图标：点击复制仓库地址
- [ ] 在概览页显示文档更新时间（基于最后一个更新的文档）
- [ ] 在概览页显示分支信息（clone_branch）
- [ ] 在概览页显示 commit id（clone_commit_id，前8位）
- [ ] 中文与英文文案可切换
- [ ] 移动端与桌面端均可正常展示
- [ ] 响应式设计，适应不同屏幕尺寸
- [ ] 布局美观大方，信息层次清晰

# 3. 非目标（Explicitly Out of Scope）
- 不新增或修改后端 API
- 不修改仓库名称或编辑入口
- 不改变文档内容编辑与导出功能
- 仓库名称本身不提供跳转功能

# 4. 使用场景 / 用户路径
1. 用户进入仓库详情页并点击查看文档
2. 文档展示页左侧边栏顶部显示仓库名称
3. 用户通过仓库名称确认文档来源
4. 用户点击跳转图标，打开仓库地址（GitHub/GitLab 等）
5. 用户点击复制图标，将仓库地址复制到剪贴板
6. 用户进入文档概览页，内容区域顶部显示仓库名称
7. 用户在概览页可查看文档更新时间、分支和commit id信息

# 5. 功能需求清单（Checklist）
- [ ] 在文档展示页左侧边栏顶部显示仓库名称（16px 字体）
- [ ] 在文档概览页内容区域顶部显示仓库名称（24px 字体）
- [ ] 仓库名称显示在"返回首页"按钮之前（侧边栏）
- [ ] 仓库名称显示在统计数据之前（概览页）
- [ ] 使用仓库的 name 字段
- [ ] 仓库名称不可点击，仅作为显示文本
- [ ] 仓库名称下方显示两个图标按钮：
  - [ ] 跳转图标（↗）：点击在新标签页打开仓库地址（repository.url）
  - [ ] 复制图标（📋）：点击将仓库地址复制到剪贴板，并显示复制成功提示
- [ ] 仓库地址为空时，图标按钮不显示或禁用
- [ ] 复制成功后显示友好的提示消息
- [ ] 在概览页显示文档更新时间：
  - [ ] 使用该仓库下最后一个更新的文档的 updated_at
  - [ ] 使用 formatDateTime 函数格式化显示
  - [ ] 显示时钟图标
- [ ] 在概览页显示分支信息：
  - [ ] 使用 repository.clone_branch 字段
  - [ ] 使用蓝色 Tag 样式显示
- [ ] 在概览页显示 commit id：
  - [ ] 使用 repository.clone_commit_id 字段
  - [ ] 只显示前8位字符
  - [ ] 使用等宽字体
  - [ ] 使用默认 Tag 样式显示
- [ ] 保持现有布局与操作按钮可用
- [ ] 响应式设计：
  - [ ] 桌面端：显示在左侧边栏（Sider）顶部
  - [ ] 移动端：显示在侧边栏抽屉（Drawer）顶部
  - [ ] 图标按钮在不同屏幕尺寸下保持可用
  - [ ] 概览页信息区域在小屏幕上自动换行

# 6. 约束条件（非常关键）
- 技术约束：使用现有 repositoryApi 与类型定义，不新增 API
- 架构约束：仅修改前端文档显示页面
- 安全约束：不得在日志中输出敏感信息
- 性能约束：不引入额外的长链路请求或阻塞渲染
- 响应式约束：必须在桌面端和移动端都能正常使用
- 布局约束：信息层次清晰，美观大方

# 7. 可修改 / 不可修改项
- ❌ 不可修改：后端接口、数据库结构、路由结构
- ✅ 可调整：文档显示页左侧边栏布局与样式、概览页布局与样式

# 8. 接口与数据约定（如适用）
- 使用接口：GET /repositories/:id
- 关键字段：
  - `name`: 仓库名称（用于显示）
  - `url`: 仓库地址（用于跳转和复制）
  - `clone_branch`: 克隆分支（用于显示）
  - `clone_commit_id`: 克隆 commit id（用于显示）
- Document 字段：
  - `updated_at`: 文档更新时间（用于计算最后更新时间）

# 9. 验收标准（Acceptance Criteria）
- 文档展示页左侧边栏顶部可见仓库名称（16px，加粗）
- 文档概览页内容区域顶部可见仓库名称（24px，加粗）
- 仓库名称显示在"返回首页"按钮之前（侧边栏）
- 仓库名称显示在统计数据之前（概览页）
- 仓库名称不可点击
- 仓库名称旁边可见跳转图标和复制图标
- 概览页可见文档更新时间（基于最后一个更新的文档）
- 概览页可见分支信息（蓝色 Tag 样式）
- 概览页可见 commit id（前8位，等宽字体，Tag 样式）
- 点击跳转图标在新标签页打开仓库地址
- 点击复制图标将仓库地址复制到剪贴板，并显示成功提示
- 仓库地址为空时，图标按钮不显示
- 中文与英文环境下均可正常显示
- 切换文档、编辑与导出功能保持可用
- 桌面端（大屏）显示在左侧边栏顶部
- 移动端（小屏）显示在侧边栏抽屉顶部
- 图标按钮在移动端和桌面端均可正常点击
- 概览页信息布局美观大方，信息层次清晰

# 10. 风险与已知不确定点
- 如果仓库信息获取失败，文档内容仍需正常展示
- 仓库名称过长时需要适当截断或省略显示
- 仓库地址为空时，图标按钮的显示逻辑需要清晰
- 移动端侧边栏抽屉打开时，仓库名称需要清晰可见
- 概览页信息在小屏幕上需要自动换行适应

# 11. 非目标
- 不在文档页提供其他仓库管理功能
- 仓库名称本身不提供跳转功能
- 不在侧边栏显示文档更新时间、分支和commit id（仅在概览页显示）
