# 042-同步对端地址管理-需求.md

# 0. 文件修改记录表

| 修改人 | 修改时间 | 修改内容 |
| ------ | -------- | -------- |
| AI | 2026-02-15 | 初始版本 |
| AI | 2026-02-15 | 存储方式调整为数据库持久化 |

## 一、背景（Why）

当前同步页面每次都需要手动输入对端服务器地址，频繁复制粘贴容易出错且效率低。需要在同步页面提供对端地址的记录与快速选择能力，减少重复输入。

## 二、目标（What，必须可验证）

- [ ] 在 `/sync` 页面支持记录对端服务器地址
- [ ] 支持从已记录地址中一键点选填充目标服务器输入框
- [ ] 支持删除已记录地址
- [ ] 支持地址去重与基本格式校验（`http(s)://host[:port]/api/sync`）

## 三、非目标（Explicitly Out of Scope）

- 不中断现有同步接口能力
- 不涉及用户账号与权限体系
- 不变更同步接口的业务逻辑

## 四、详细需求

### 4.1 地址记录与存储

- 记录方式：在同步页面保存用户输入的对端地址
- 存储范围：服务端数据库持久化
- 范围边界：当前实例全局共享（不区分用户）
- 去重规则：同一地址只保留一条记录（字符串完全一致）
- 地址上限：默认最多保留 20 条（超出时移除最旧记录）

### 4.2 页面交互

- 在目标服务器输入框旁新增“保存地址”操作
- 在输入框下方展示“常用对端地址”列表
- 点击列表项时，自动填充目标服务器输入框
- 列表项提供删除操作

### 4.3 格式校验

- 地址必须以 `http://` 或 `https://` 开头
- 地址必须包含 `/api/sync` 后缀
- 校验失败时提示用户并禁止保存

## 五、验收标准

1. 在 `/sync` 页面可保存对端地址并持久化
2. 刷新页面后仍可看到已保存地址
3. 点击地址可自动填充目标服务器输入框
4. 删除地址后列表即时更新
5. 保存非法地址时有明确错误提示

## 六、安全与隐私

- 地址保存在服务端数据库，仅用于当前实例的同步管理
- 不记录 Token、账号、密码等敏感信息
