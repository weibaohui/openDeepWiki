# 类型定义规范

本文档定义 TypeScript 类型的组织和导入方式。

## 类型文件组织

```tsx
// types/index.ts
export interface Repository {
  id: number;
  name: string;
  url: string;
  status: RepositoryStatus;
  created_at: string;
  updated_at: string;
}

export type RepositoryStatus = 
  | 'pending' 
  | 'cloning' 
  | 'ready' 
  | 'analyzing' 
  | 'completed' 
  | 'error';

export interface Task {
  id: number;
  repository_id: number;
  type: TaskType;
  status: TaskStatus;
  title: string;
}

export type TaskType = 'overview' | 'architecture' | 'api' | 'business-flow' | 'deployment';
export type TaskStatus = 'pending' | 'running' | 'completed' | 'failed';

export interface Document {
  id: number;
  repository_id: number;
  task_id: number;
  title: string;
  path: string;
  content: string;
  created_at: string;
  updated_at: string;
}
```

## 类型导入

```tsx
// 使用 type 关键字导入类型
import type { Repository, Task } from '@/types';

// 不推荐：混合导入
import { Repository, someFunction } from '@/types';
```

## 组件 Props 类型

```tsx
// 方式一：内联定义（简单组件）
function Button({ label, onClick }: { label: string; onClick: () => void }) {
  return <button onClick={onClick}>{label}</button>;
}

// 方式二：接口定义（推荐）
interface ButtonProps {
  label: string;
  variant?: 'primary' | 'secondary';
  disabled?: boolean;
  onClick?: () => void;
}

function Button({ label, variant = 'primary', disabled, onClick }: ButtonProps) {
  // ...
}

// 方式三：继承 HTML 属性
interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: 'primary' | 'secondary';
}
```

## API 响应类型

```tsx
// 通用响应类型
interface ApiResponse<T> {
  data: T;
  message?: string;
}

interface PaginatedResponse<T> {
  data: T[];
  total: number;
  page: number;
  page_size: number;
}

// 使用
const response = await api.get<ApiResponse<Repository>>('/repositories/1');
const repo = response.data.data;
```

## 枚举 vs 联合类型

```tsx
// 推荐：使用联合类型
type Status = 'pending' | 'running' | 'completed' | 'failed';

// 不推荐：使用枚举（增加运行时代码）
enum Status {
  Pending = 'pending',
  Running = 'running',
  Completed = 'completed',
  Failed = 'failed',
}
```

## 常量对象类型

```tsx
// 定义常量对象
const TASK_TYPES = {
  OVERVIEW: 'overview',
  ARCHITECTURE: 'architecture',
  API: 'api',
  BUSINESS_FLOW: 'business-flow',
  DEPLOYMENT: 'deployment',
} as const;

// 提取类型
type TaskType = typeof TASK_TYPES[keyof typeof TASK_TYPES];
// 等价于: 'overview' | 'architecture' | 'api' | 'business-flow' | 'deployment'
```

## 工具类型

```tsx
// 部分可选
type PartialRepository = Partial<Repository>;

// 部分必选
type RequiredRepository = Required<Repository>;

// 选择部分字段
type RepositorySummary = Pick<Repository, 'id' | 'name' | 'status'>;

// 排除部分字段
type RepositoryInput = Omit<Repository, 'id' | 'created_at' | 'updated_at'>;
```

## 相关文档

- [组件编写规范](./03-组件编写规范.md)
- [API 调用规范](./09-API调用规范.md)
