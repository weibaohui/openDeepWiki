# 禁止事项

本文档列出前端开发中严禁和应避免的编码方式。

本文示例不包含代码注释，原示例注释已移除，如需保留请自行补充。

## 严禁
 
### 禁止保留未使用引入及变量

不能出现引入但未使用的组件、变量。

### 使用与规范不一致的 UI/样式/图标/i18n/主题库
 
```
禁止使用：Tailwind CSS、shadcn/ui、Lucide React、i18next、react-i18next、next-themes
统一使用：Ant Design、@ant-design/icons、ConfigProvider locale、Ant Design 主题算法与 Token
```

### 使用 any 类型

```tsx
// 禁止
const data: any = fetchData();

// 正确：定义具体类型
const data: Repository = fetchData();

// 如实在无法确定，使用 unknown
const data: unknown = fetchData();
```

### 在组件内定义内联样式对象

```tsx
// 禁止：每次渲染创建新对象
<div style={{ color: 'red', padding: 10 }}>

// 正确：使用 Ant Design 或提取常量
<Button type="primary">保存</Button>

// 或
const styles = { color: 'red', padding: 10 };
<div style={styles}>
```

### 直接操作 DOM

```tsx
// 禁止
document.getElementById('btn').addEventListener('click', ...);

// 正确：使用 React ref 和事件处理
const btnRef = useRef<HTMLButtonElement>(null);
<button ref={btnRef} onClick={handleClick}>
```

### 在渲染阶段产生副作用

```tsx
// 禁止
function Component() {
  fetchData(); // 直接在渲染中调用
  localStorage.setItem('key', 'value'); // 直接操作存储
  return <div>...</div>;
}

// 正确：使用 useEffect
function Component() {
  useEffect(() => {
    fetchData();
  }, []);
  return <div>...</div>;
}
```

### 使用 index 作为列表 key

```tsx
// 禁止（当列表会变动时）
{items.map((item, index) => (
  <Item key={index} data={item} />
))}

// 正确：使用唯一标识
{items.map(item => (
  <Item key={item.id} data={item} />
))}
```

### 忽略依赖数组

```tsx
// 禁止
useEffect(() => {
  fetchData(id);
}, []); // 缺少 id 依赖

// 正确
useEffect(() => {
  fetchData(id);
}, [id]);
```

## 应避免

### 过度使用 Context

```tsx
// 避免：为每个小状态创建 Context
const CountContext = createContext(0);
const NameContext = createContext('');
const ThemeContext = createContext('light');

// 推荐：组合相关状态或使用组件组合
```

### 组件嵌套超过 5 层

```tsx
// 避免
<A>
  <B>
    <C>
      <D>
        <E>
          <F>实际内容</F>
        </E>
      </D>
    </C>
  </B>
</A>

// 推荐：重构组件结构，减少嵌套
```

### 单个文件超过 300 行

当文件过长时，应考虑：
- 提取子组件
- 提取自定义 Hook
- 提取工具函数

### 不处理 useEffect 清理函数

```tsx
// 避免
useEffect(() => {
  const timer = setInterval(() => {}, 1000);
  // 没有清理
}, []);

// 正确
useEffect(() => {
  const timer = setInterval(() => {}, 1000);
  return () => clearInterval(timer); // 清理
}, []);
```

### 忽略 TypeScript 错误

```tsx
// 避免
// @ts-ignore
const value = data.something;

// 正确：修复类型问题
const value = data?.something;
```

### 硬编码字符串

```tsx
// 避免
<Button>保存</Button>

// 正确：使用项目多语言
<Button>{getMessage(locale, 'common.save')}</Button>
```

### 未处理加载和错误状态

```tsx
// 避免
function List() {
  const [data, setData] = useState([]);
  useEffect(() => {
    fetchData().then(setData);
  }, []);
  return <ul>{data.map(...)}</ul>;
}

// 正确
function List() {
  const [data, setData] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  
  // ... 完整的状态处理
  
  if (loading) return <Skeleton />;
  if (error) return <Error />;
  return <ul>{data.map(...)}</ul>;
}
```

## 相关文档

- [最佳实践](./12-最佳实践.md)
- [代码审查清单](./14-代码审查清单.md)
 - [国际化规范](./07-国际化规范.md)
