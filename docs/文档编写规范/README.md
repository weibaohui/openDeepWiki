# AI 文档读写与存放规则（Document IO Rules for AI）

> 本文档定义 **AI 在代码仓库中如何读取、创建、更新文档的强制规则**。
>
> 目标：
>
> * 防止 AI 乱放文档、重复造文档
> * 让 AI 能“按结构理解项目”，而不是靠上下文猜
> * 为自动化校验、审计和回溯提供稳定基础

---

## 1. 总体原则（必须遵守）

1. **目录即职责**：

   * AI 不得随意新增文档目录
   * 每个目录只承载一种职责类型的文档

2. **编号即关联**：

   * 所有需求相关文档必须使用统一编号
   * 不得通过文件夹嵌套表达功能关联

3. **先读后写**：

   * 在创建或修改任何文档前，AI 必须先读取对应目录下的已有文档

4. **不覆盖、不合并、不重命名历史文档**：

   * 除非需求文档明确要求

---

## 2. 标准文档目录结构（只允许以下结构）

```text
docs/
  bugs/                # 缺陷问题处理记录文档
  requirements/        # 需求 & 实现总结
  design/              # 设计 / 实现方案（编码前）
  testing/             # 测试设计文档
  decisions/           # 架构与关键决策（可选）
```

> ❗ AI 不得在 `docs/` 下新增其他一级目录。

---

## 3. 文档命名统一规则（强制）

### 3.1 基本命名格式

```text
<编号>-<功能名称>-<文档类型>.md
```

* `<编号>`：需求编号，如 `001`、`AUTH-003`
* `<功能名称>`：简短、稳定、无空格
* `<文档类型>`：固定枚举，不可自造

---

### 3.2 各目录允许的文档类型


#### docs/bugs/
每个缺陷一个目录docs/bugs/001-仓库分支无法创建/具体文档XXX.md

| 文档类型 | 说明             |
| -------- | ---------------- |
| 缺陷说明     | 对缺陷本身的描述说明     |
| 缺陷分析     | 缺陷分析说明     |
| 修复总结 | 缺陷修复后的总结 |

示例：

```text
001-仓库分支无法创建-缺陷说明.md
001-仓库分支无法创建-缺陷分析.md
001-仓库分支无法创建-修复总结.md
```

---

#### docs/requirements/

| 文档类型 | 说明             |
| -------- | ---------------- |
| 需求     | 功能需求说明     |
| 实现总结 | 功能完成后的总结 |

示例：

```text
001-日志AI分析-需求.md
001-日志AI分析-实现总结.md
```

---

#### docs/design/

| 文档类型 | 说明                |
| -------- | ------------------- |
| 设计     | 实现方案 / 技术设计 |

示例：

```text
001-日志AI分析-设计.md
```

---

#### docs/testing/

| 文档类型 | 说明               |
| -------- | ------------------ |
| 测试     | 测试设计与验收要点 |

示例：

```text
001-日志AI分析-测试.md
```

---

#### docs/decisions/

| 文档类型 | 说明               |
| -------- | ------------------ |
| 决策     | 架构或关键技术决策 |

示例：

```text
ADR-001-日志处理方案-决策.md
```

---

## 4. AI 读取文档的顺序规则（非常重要）

当 AI 执行某个功能（编号 X）时，必须按以下顺序读取文档：

1. `docs/requirements/X-*-需求.md`
2. `docs/design/X-*-设计.md`（如存在）
3. `docs/testing/X-*-测试.md`（如存在）
4. `docs/decisions/` 下与该功能相关的决策文档

> ❗ 若需求文档不存在，AI 必须停止执行。

---

## 5. AI 创建文档的顺序规则

### 5.1 允许创建的前提条件

* 已存在对应需求文档
* 当前阶段明确需要该文档

---

### 5.2 标准创建顺序

1. 需求阶段：

   * ❌ AI 不得创建需求文档（除非明确授权）

2. 设计阶段：

   * 创建 `docs/design/<编号>-*-设计.md`

3. 测试设计阶段：

   * 创建 `docs/testing/<编号>-*-测试.md`

4. 实现完成后：

   * 创建 `docs/requirements/<编号>-*-实现总结.md`

---

## 6. 文档修改规则

1. AI 只能修改：

   * 自己创建的文档
   * 明确要求其更新的文档

2. 修改时必须：

   * 保留原有结构
   * 明确新增或变更内容

3. 禁止行为：

   * 删除关键段落
   * 合并不同职责文档

---

## 7. 文档缺失与冲突处理

* 若发现应存在但不存在的文档：

  * 明确指出缺失项
  * 停止后续代码或设计工作

* 若文档内容存在冲突：

  * 标注冲突点
  * 等待人工确认

---

## 8. 规则声明（对 AI 生效）

> * 不符合本规则的文档视为无效输入
> * 不符合本规则的请求，AI 应拒绝执行
> * 本规则优先级高于临时指令

---

> **核心约束总结**：
>
> 👉 目录决定角色
>
> 👉 文件名决定关系
>
> 👉 顺序决定权限
